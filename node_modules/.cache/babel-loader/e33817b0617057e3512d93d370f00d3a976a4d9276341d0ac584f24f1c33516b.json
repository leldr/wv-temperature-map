{"ast":null,"code":"// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport { createHttpHeaders, createPipelineRequest } from \"@azure/core-rest-pipeline\";\nimport { credentialLogger, formatError, formatSuccess } from \"../util/logging\";\nimport { processMultiTenantRequest, resolveAdditionallyAllowedTenantIds } from \"../util/tenantIdUtils\";\nimport { IdentityClient } from \"../client/identityClient\";\nimport { getIdentityTokenEndpointSuffix } from \"../util/identityTokenEndpoint\";\nimport { tracingClient } from \"../util/tracing\";\nconst logger = credentialLogger(\"ClientSecretCredential\");\n// This credential is exported on browser bundles for development purposes.\n// For this credential to work in browsers, browsers would need to have security features disabled.\n// Please do not disable your browser security features.\n/**\n * Enables authentication to Microsoft Entra ID using a client secret\n * that was generated for an App Registration.  More information on how\n * to configure a client secret can be found here:\n *\n * https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-access-web-apis#add-credentials-to-your-web-application\n *\n */\nexport class ClientSecretCredential {\n  /**\n   * Creates an instance of the ClientSecretCredential with the details\n   * needed to authenticate against Microsoft Entra ID with a client\n   * secret.\n   *\n   * @param tenantId - The Microsoft Entra tenant (directory) ID.\n   * @param clientId - The client (application) ID of an App Registration in the tenant.\n   * @param clientSecret - A client secret that was generated for the App Registration.\n   * @param options - Options for configuring the client which makes the authentication request.\n   */\n  constructor(tenantId, clientId, clientSecret, options) {\n    this.identityClient = new IdentityClient(options);\n    this.tenantId = tenantId;\n    this.additionallyAllowedTenantIds = resolveAdditionallyAllowedTenantIds(options === null || options === void 0 ? void 0 : options.additionallyAllowedTenants);\n    this.clientId = clientId;\n    this.clientSecret = clientSecret;\n  }\n  /**\n   * Authenticates with Microsoft Entra ID and returns an access token if\n   * successful.  If authentication cannot be performed at this time, this method may\n   * return null.  If an error occurs during authentication, an {@link AuthenticationError}\n   * containing failure details will be thrown.\n   *\n   * @param scopes - The list of scopes for which the token will have access.\n   * @param options - The options used to configure any requests this\n   *                TokenCredential implementation might make.\n   */\n  async getToken(scopes, options = {}) {\n    return tracingClient.withSpan(`${this.constructor.name}.getToken`, options, async newOptions => {\n      const tenantId = processMultiTenantRequest(this.tenantId, newOptions, this.additionallyAllowedTenantIds);\n      const query = new URLSearchParams({\n        response_type: \"token\",\n        grant_type: \"client_credentials\",\n        client_id: this.clientId,\n        client_secret: this.clientSecret,\n        scope: typeof scopes === \"string\" ? scopes : scopes.join(\" \")\n      });\n      try {\n        const urlSuffix = getIdentityTokenEndpointSuffix(tenantId);\n        const request = createPipelineRequest({\n          url: `${this.identityClient.authorityHost}/${tenantId}/${urlSuffix}`,\n          method: \"POST\",\n          body: query.toString(),\n          headers: createHttpHeaders({\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          }),\n          abortSignal: options && options.abortSignal,\n          tracingOptions: newOptions === null || newOptions === void 0 ? void 0 : newOptions.tracingOptions\n        });\n        const tokenResponse = await this.identityClient.sendTokenRequest(request);\n        logger.getToken.info(formatSuccess(scopes));\n        return tokenResponse && tokenResponse.accessToken || null;\n      } catch (err) {\n        logger.getToken.info(formatError(scopes, err));\n        throw err;\n      }\n    });\n  }\n}","map":{"version":3,"names":["createHttpHeaders","createPipelineRequest","credentialLogger","formatError","formatSuccess","processMultiTenantRequest","resolveAdditionallyAllowedTenantIds","IdentityClient","getIdentityTokenEndpointSuffix","tracingClient","logger","ClientSecretCredential","constructor","tenantId","clientId","clientSecret","options","identityClient","additionallyAllowedTenantIds","additionallyAllowedTenants","getToken","scopes","withSpan","name","newOptions","query","URLSearchParams","response_type","grant_type","client_id","client_secret","scope","join","urlSuffix","request","url","authorityHost","method","body","toString","headers","Accept","abortSignal","tracingOptions","tokenResponse","sendTokenRequest","info","accessToken","err"],"sources":["C:\\Users\\phlos\\wv-temperature-map\\src\\backend\\node_modules\\@azure\\identity\\src\\credentials\\clientSecretCredential.browser.ts"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport { AccessToken, GetTokenOptions, TokenCredential } from \"@azure/core-auth\";\nimport { createHttpHeaders, createPipelineRequest } from \"@azure/core-rest-pipeline\";\nimport { credentialLogger, formatError, formatSuccess } from \"../util/logging\";\nimport {\n  processMultiTenantRequest,\n  resolveAdditionallyAllowedTenantIds,\n} from \"../util/tenantIdUtils\";\nimport { ClientSecretCredentialOptions } from \"./clientSecretCredentialOptions\";\nimport { IdentityClient } from \"../client/identityClient\";\nimport { getIdentityTokenEndpointSuffix } from \"../util/identityTokenEndpoint\";\nimport { tracingClient } from \"../util/tracing\";\n\nconst logger = credentialLogger(\"ClientSecretCredential\");\n\n// This credential is exported on browser bundles for development purposes.\n// For this credential to work in browsers, browsers would need to have security features disabled.\n// Please do not disable your browser security features.\n\n/**\n * Enables authentication to Microsoft Entra ID using a client secret\n * that was generated for an App Registration.  More information on how\n * to configure a client secret can be found here:\n *\n * https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-access-web-apis#add-credentials-to-your-web-application\n *\n */\nexport class ClientSecretCredential implements TokenCredential {\n  private identityClient: IdentityClient;\n  private tenantId: string;\n  private additionallyAllowedTenantIds: string[];\n  private clientId: string;\n  private clientSecret: string;\n\n  /**\n   * Creates an instance of the ClientSecretCredential with the details\n   * needed to authenticate against Microsoft Entra ID with a client\n   * secret.\n   *\n   * @param tenantId - The Microsoft Entra tenant (directory) ID.\n   * @param clientId - The client (application) ID of an App Registration in the tenant.\n   * @param clientSecret - A client secret that was generated for the App Registration.\n   * @param options - Options for configuring the client which makes the authentication request.\n   */\n  constructor(\n    tenantId: string,\n    clientId: string,\n    clientSecret: string,\n    options?: ClientSecretCredentialOptions,\n  ) {\n    this.identityClient = new IdentityClient(options);\n    this.tenantId = tenantId;\n    this.additionallyAllowedTenantIds = resolveAdditionallyAllowedTenantIds(\n      options?.additionallyAllowedTenants,\n    );\n    this.clientId = clientId;\n    this.clientSecret = clientSecret;\n  }\n\n  /**\n   * Authenticates with Microsoft Entra ID and returns an access token if\n   * successful.  If authentication cannot be performed at this time, this method may\n   * return null.  If an error occurs during authentication, an {@link AuthenticationError}\n   * containing failure details will be thrown.\n   *\n   * @param scopes - The list of scopes for which the token will have access.\n   * @param options - The options used to configure any requests this\n   *                TokenCredential implementation might make.\n   */\n  public async getToken(\n    scopes: string | string[],\n    options: GetTokenOptions = {},\n  ): Promise<AccessToken | null> {\n    return tracingClient.withSpan(\n      `${this.constructor.name}.getToken`,\n      options,\n      async (newOptions) => {\n        const tenantId = processMultiTenantRequest(\n          this.tenantId,\n          newOptions,\n          this.additionallyAllowedTenantIds,\n        );\n\n        const query = new URLSearchParams({\n          response_type: \"token\",\n          grant_type: \"client_credentials\",\n          client_id: this.clientId,\n          client_secret: this.clientSecret,\n          scope: typeof scopes === \"string\" ? scopes : scopes.join(\" \"),\n        });\n\n        try {\n          const urlSuffix = getIdentityTokenEndpointSuffix(tenantId!);\n          const request = createPipelineRequest({\n            url: `${this.identityClient.authorityHost}/${tenantId!}/${urlSuffix}`,\n            method: \"POST\",\n            body: query.toString(),\n            headers: createHttpHeaders({\n              Accept: \"application/json\",\n              \"Content-Type\": \"application/x-www-form-urlencoded\",\n            }),\n            abortSignal: options && options.abortSignal,\n            tracingOptions: newOptions?.tracingOptions,\n          });\n\n          const tokenResponse = await this.identityClient.sendTokenRequest(request);\n          logger.getToken.info(formatSuccess(scopes));\n          return (tokenResponse && tokenResponse.accessToken) || null;\n        } catch (err: any) {\n          logger.getToken.info(formatError(scopes, err));\n          throw err;\n        }\n      },\n    );\n  }\n}\n"],"mappings":"AAAA;AACA;AAGA,SAASA,iBAAiB,EAAEC,qBAAqB,QAAQ,2BAA2B;AACpF,SAASC,gBAAgB,EAAEC,WAAW,EAAEC,aAAa,QAAQ,iBAAiB;AAC9E,SACEC,yBAAyB,EACzBC,mCAAmC,QAC9B,uBAAuB;AAE9B,SAASC,cAAc,QAAQ,0BAA0B;AACzD,SAASC,8BAA8B,QAAQ,+BAA+B;AAC9E,SAASC,aAAa,QAAQ,iBAAiB;AAE/C,MAAMC,MAAM,GAAGR,gBAAgB,CAAC,wBAAwB,CAAC;AAEzD;AACA;AACA;AAEA;;;;;;;;AAQA,OAAM,MAAOS,sBAAsB;EAOjC;;;;;;;;;;EAUAC,YACEC,QAAgB,EAChBC,QAAgB,EAChBC,YAAoB,EACpBC,OAAuC;IAEvC,IAAI,CAACC,cAAc,GAAG,IAAIV,cAAc,CAACS,OAAO,CAAC;IACjD,IAAI,CAACH,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACK,4BAA4B,GAAGZ,mCAAmC,CACrEU,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,0BAA0B,CACpC;IACD,IAAI,CAACL,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACC,YAAY,GAAGA,YAAY;EAClC;EAEA;;;;;;;;;;EAUO,MAAMK,QAAQA,CACnBC,MAAyB,EACzBL,OAAA,GAA2B,EAAE;IAE7B,OAAOP,aAAa,CAACa,QAAQ,CAC3B,GAAG,IAAI,CAACV,WAAW,CAACW,IAAI,WAAW,EACnCP,OAAO,EACP,MAAOQ,UAAU,IAAI;MACnB,MAAMX,QAAQ,GAAGR,yBAAyB,CACxC,IAAI,CAACQ,QAAQ,EACbW,UAAU,EACV,IAAI,CAACN,4BAA4B,CAClC;MAED,MAAMO,KAAK,GAAG,IAAIC,eAAe,CAAC;QAChCC,aAAa,EAAE,OAAO;QACtBC,UAAU,EAAE,oBAAoB;QAChCC,SAAS,EAAE,IAAI,CAACf,QAAQ;QACxBgB,aAAa,EAAE,IAAI,CAACf,YAAY;QAChCgB,KAAK,EAAE,OAAOV,MAAM,KAAK,QAAQ,GAAGA,MAAM,GAAGA,MAAM,CAACW,IAAI,CAAC,GAAG;OAC7D,CAAC;MAEF,IAAI;QACF,MAAMC,SAAS,GAAGzB,8BAA8B,CAACK,QAAS,CAAC;QAC3D,MAAMqB,OAAO,GAAGjC,qBAAqB,CAAC;UACpCkC,GAAG,EAAE,GAAG,IAAI,CAAClB,cAAc,CAACmB,aAAa,IAAIvB,QAAS,IAAIoB,SAAS,EAAE;UACrEI,MAAM,EAAE,MAAM;UACdC,IAAI,EAAEb,KAAK,CAACc,QAAQ,EAAE;UACtBC,OAAO,EAAExC,iBAAiB,CAAC;YACzByC,MAAM,EAAE,kBAAkB;YAC1B,cAAc,EAAE;WACjB,CAAC;UACFC,WAAW,EAAE1B,OAAO,IAAIA,OAAO,CAAC0B,WAAW;UAC3CC,cAAc,EAAEnB,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAEmB;SAC7B,CAAC;QAEF,MAAMC,aAAa,GAAG,MAAM,IAAI,CAAC3B,cAAc,CAAC4B,gBAAgB,CAACX,OAAO,CAAC;QACzExB,MAAM,CAACU,QAAQ,CAAC0B,IAAI,CAAC1C,aAAa,CAACiB,MAAM,CAAC,CAAC;QAC3C,OAAQuB,aAAa,IAAIA,aAAa,CAACG,WAAW,IAAK,IAAI;MAC7D,CAAC,CAAC,OAAOC,GAAQ,EAAE;QACjBtC,MAAM,CAACU,QAAQ,CAAC0B,IAAI,CAAC3C,WAAW,CAACkB,MAAM,EAAE2B,GAAG,CAAC,CAAC;QAC9C,MAAMA,GAAG;MACX;IACF,CAAC,CACF;EACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}